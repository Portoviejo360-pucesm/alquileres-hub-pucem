<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portoviejo360 - GestiÃ³n de Incidencias</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <header>
        <div class="container">
            <h1>ğŸ™ï¸ Portoviejo360</h1>
            <p class="subtitle">Sistema de GestiÃ³n de Incidencias</p>
        </div>
    </header>

    <main class="container">
        <!-- ConfiguraciÃ³n API -->
        <section class="card config-section">
            <h2>âš™ï¸ ConfiguraciÃ³n</h2>
            <div class="form-group">
                <label for="apiUrl">URL del API:</label>
                <input type="text" id="apiUrl" value="http://localhost:3000/api" placeholder="http://localhost:3000/api">
            </div>
            <div class="form-group">
                <label for="authToken">Token JWT:</label>
                <input type="text" id="authToken" placeholder="Ingresa tu token de autenticaciÃ³n">
            </div>
            <button id="btnTestConnection" class="btn btn-secondary">ğŸ”Œ Probar ConexiÃ³n</button>
            <span id="connectionStatus" class="status-badge"></span>
        </section>

        <!-- Crear Incidencia -->
        <section class="card">
            <h2>â• Crear Nueva Incidencia</h2>
            <form id="formCreateIncident">
                <div class="form-row">
                    <div class="form-group">
                        <label for="titulo">TÃ­tulo:</label>
                        <input type="text" id="titulo" required minlength="3" maxlength="200" placeholder="TÃ­tulo de la incidencia">
                    </div>
                    <div class="form-group">
                        <label for="propiedad_id">ID Propiedad:</label>
                        <input type="number" id="propiedad_id" required min="1" value="1" placeholder="ID de propiedad">
                    </div>
                </div>
                <div class="form-group">
                    <label for="descripcion">DescripciÃ³n:</label>
                    <textarea id="descripcion" required minlength="10" rows="3" placeholder="Describe la incidencia con al menos 10 caracteres"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="prioridad_codigo">Prioridad:</label>
                        <select id="prioridad_codigo" required>
                            <option value="LOW">ğŸŸ¢ Baja</option>
                            <option value="MEDIUM" selected>ğŸŸ¡ Media</option>
                            <option value="HIGH">ğŸŸ  Alta</option>
                            <option value="CRITICAL">ğŸ”´ CrÃ­tica</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="categoria_codigo">CategorÃ­a:</label>
                        <select id="categoria_codigo">
                            <option value="">Sin categorÃ­a</option>
                            <option value="ELECTRICAL">âš¡ ElÃ©ctrica</option>
                            <option value="PLUMBING">ğŸ”§ PlomerÃ­a</option>
                            <option value="STRUCTURAL">ğŸ—ï¸ Estructural</option>
                            <option value="GENERAL">ğŸ“‹ General</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="incidentFiles">ğŸ“ Archivos adjuntos (opcional, mÃ¡x. 5 imÃ¡genes):</label>
                    <input type="file" id="incidentFiles" multiple accept="image/jpeg,image/png,image/jpg,image/webp">
                    <div id="filePreview" class="file-preview"></div>
                </div>
                <button type="submit" class="btn btn-primary">Crear Incidencia</button>
            </form>
            <div id="createResult" class="result-box"></div>
        </section>

        <!-- Listar Incidencias -->
        <section class="card">
            <h2>ğŸ“‹ Listar Incidencias</h2>
            <div class="form-row">
                <div class="form-group">
                    <label for="filterStatus">Filtrar por Estado:</label>
                    <select id="filterStatus">
                        <option value="">Todos</option>
                        <option value="OPEN">Abierto</option>
                        <option value="IN_PROGRESS">En Progreso</option>
                        <option value="RESOLVED">Resuelto</option>
                        <option value="CLOSED">Cerrado</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="filterLimit">LÃ­mite:</label>
                    <input type="number" id="filterLimit" value="10" min="1" max="100">
                </div>
            </div>
            <button id="btnListIncidents" class="btn btn-primary">ğŸ”„ Cargar Incidencias</button>
            <div id="incidentsList" class="incidents-grid"></div>
        </section>

        <!-- Operaciones por ID -->
        <section class="card">
            <h2>ğŸ” Operaciones por ID</h2>
            <div class="form-group">
                <label for="incidentId">ID de Incidencia:</label>
                <input type="number" id="incidentId" min="1" placeholder="Ingresa el ID">
            </div>
            <div class="button-group">
                <button id="btnGetById" class="btn btn-secondary">ğŸ“„ Obtener</button>
                <button id="btnDeleteById" class="btn btn-danger">ğŸ—‘ï¸ Eliminar</button>
            </div>
            <div id="detailResult" class="result-box"></div>
        </section>

        <!-- Actualizar Estado -->
        <section class="card">
            <h2>ğŸ”„ Actualizar Estado</h2>
            <div class="form-row">
                <div class="form-group">
                    <label for="updateId">ID de Incidencia:</label>
                    <input type="number" id="updateId" min="1" placeholder="ID">
                </div>
                <div class="form-group">
                    <label for="newStatus">Nuevo Estado:</label>
                    <select id="newStatus" required>
                        <option value="OPEN">ğŸŸ¢ Abierto</option>
                        <option value="IN_PROGRESS">ğŸ”µ En Progreso</option>
                        <option value="RESOLVED">ğŸŸ£ Resuelto</option>
                        <option value="CLOSED">âš« Cerrado</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label for="statusDescription">DescripciÃ³n del cambio:</label>
                <input type="text" id="statusDescription" placeholder="Opcional: razÃ³n del cambio de estado">
            </div>
            <button id="btnUpdateStatus" class="btn btn-primary">Actualizar Estado</button>
            <div id="updateResult" class="result-box"></div>
        </section>

        <!-- Comentarios -->
        <section class="card">
            <h2>ğŸ’¬ Agregar Comentario</h2>
            <div class="form-row">
                <div class="form-group">
                    <label for="commentIncidentId">ID de Incidencia:</label>
                    <input type="number" id="commentIncidentId" min="1" placeholder="ID">
                </div>
                <div class="form-group">
                    <label for="commentInternal">
                        <input type="checkbox" id="commentInternal"> Comentario Interno
                    </label>
                </div>
            </div>
            <div class="form-group">
                <label for="commentContent">Comentario:</label>
                <textarea id="commentContent" rows="2" placeholder="Escribe tu comentario"></textarea>
            </div>
            <button id="btnAddComment" class="btn btn-primary">Agregar Comentario</button>
            <div id="commentResult" class="result-box"></div>
        </section>

        <!-- Log de Peticiones -->
        <section class="card">
            <h2>ğŸ“ Log de Peticiones</h2>
            <button id="btnClearLog" class="btn btn-secondary">ğŸ§¹ Limpiar Log</button>
            <div id="requestLog" class="log-container"></div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>Portoviejo360 - Frontend de Pruebas | VersiÃ³n 1.0</p>
        </div>
    </footer>

    <script src="js/app.js"></script>
</body>
</html>
